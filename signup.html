<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login/Signup</title>
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <style>
    :root {
      --primary-color: rgb(211, 130, 16);
      --secondary-color: rgb(211, 130, 16);
      --white: #ffffff;
      --gray: #efefef;
      --gray-2: #757575;
      --facebook-color: #4267B2;
      --google-color: #DB4437;
      --twitter-color: #1DA1F2;
      --insta-color: #E1306C;
    }

    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600&display=swap');

    * {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100vh;
      overflow: hidden;
    }

    .container {
      position: relative;
      min-height: 100vh;
      overflow: hidden;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      height: 100vh;
    }

    .col {
      width: 50%;
    }

    .align-items-center {
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .form-wrapper {
      width: 100%;
      max-width: 28rem;
    }

    .form {
      padding: 1rem;
      background-color: var(--white);
      border-radius: 1.5rem;
      width: 100%;
      box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
      transform: scale(0);
      transition: .5s ease-in-out;
      transition-delay: 1s;
    }

    .input-group {
      position: relative;
      width: 100%;
      margin: 1rem 0;
    }

    .input-group i {
      position: absolute;
      top: 50%;
      left: 1rem;
      transform: translateY(-50%);
      font-size: 1.4rem;
      color: var(--gray-2);
    }

    .input-group input {
      width: 100%;
      padding: 1rem 3rem;
      font-size: 1rem;
      background-color: var(--gray);
      border-radius: .5rem;
      border: 0.125rem solid var(--white);
      outline: none;
    }

    .input-group input:focus {
      border: 0.125rem solid var(--primary-color);
    }

    .form button {
      cursor: pointer;
      width: 100%;
      padding: .6rem 0;
      border-radius: .5rem;
      border: none;
      background-color: var(--primary-color);
      color: var(--white);
      font-size: 1.2rem;
      outline: none;
    }

    .form p {
      margin: 1rem 0;
      font-size: .7rem;
    }

    .flex-col {
      flex-direction: column;
    }

    .social-list {
      margin: 2rem 0;
      padding: 1rem;
      border-radius: 1.5rem;
      width: 100%;
      box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
      transform: scale(0);
      transition: .5s ease-in-out;
      transition-delay: 1.2s;
    }

    .social-list>div {
      color: var(--white);
      margin: 0 .5rem;
      padding: .7rem;
      cursor: pointer;
      border-radius: .5rem;
      transform: scale(0);
      transition: .5s ease-in-out;
    }

    .social-list>div:nth-child(1) { transition-delay: 1.4s; }
    .social-list>div:nth-child(2) { transition-delay: 1.6s; }
    .social-list>div:nth-child(3) { transition-delay: 1.8s; }
    .social-list>div:nth-child(4) { transition-delay: 2s; }

    .social-list>div>i {
      font-size: 1.5rem;
      transition: .4s ease-in-out;
    }

    .social-list>div:hover i { transform: scale(1.5); }

    .facebook-bg { background-color: var(--facebook-color); }
    .google-bg { background-color: var(--google-color); }
    .twitter-bg { background-color: var(--twitter-color); }
    .insta-bg { background-color: var(--insta-color); }

    .pointer { cursor: pointer; }

    .container.sign-in .form.sign-in,
    .container.sign-in .social-list.sign-in,
    .container.sign-in .social-list.sign-in>div,
    .container.sign-up .form.sign-up,
    .container.sign-up .social-list.sign-up,
    .container.sign-up .social-list.sign-up>div {
      transform: scale(1);
    }

    .content-row {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 6;
      width: 100%;
    }

    .text {
      margin: 4rem;
      color: var(--white);
    }

    .text h2 {
      font-size: 3.5rem;
      font-weight: 800;
      margin: 2rem 0;
      transition: 1s ease-in-out;
    }

    .text p {
      font-weight: 600;
      transition: 1s ease-in-out;
      transition-delay: .2s;
    }

    .img img {
      width: 30vw;
      transition: 1s ease-in-out;
      transition-delay: .4s;
    }

    .text.sign-in h2,
    .text.sign-in p,
    .img.sign-in img { transform: translateX(-250%); }

    .text.sign-up h2,
    .text.sign-up p,
    .img.sign-up img { transform: translateX(250%); }

    .container.sign-in .text.sign-in h2,
    .container.sign-in .text.sign-in p,
    .container.sign-in .img.sign-in img,
    .container.sign-up .text.sign-up h2,
    .container.sign-up .text.sign-up p,
    .container.sign-up .img.sign-up img {
      transform: translateX(0);
    }

    .container::before {
      content: "";
      position: absolute;
      top: 0; right: 0;
      height: 100vh; width: 300vw;
      transform: translate(35%, 0);
      background-image: linear-gradient(-45deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      transition: 1s ease-in-out;
      z-index: 6;
      box-shadow: rgba(0, 0, 0, 0.35) 0px 5px 15px;
      border-bottom-right-radius: max(50vw, 50vh);
      border-top-left-radius: max(50vw, 50vh);
    }

    .container.sign-in::before { transform: translate(0, 0); right: 50%; }
    .container.sign-up::before { transform: translate(100%, 0); right: 50%; }

    /* RESPONSIVE */
    @media only screen and (max-width: 425px) {
      .container::before,
      .container.sign-in::before,
      .container.sign-up::before {
        height: 100vh; border-bottom-right-radius: 0; border-top-left-radius: 0;
        z-index: 0; transform: none; right: 0;
      }
      .col {
        width: 100%; position: absolute; padding: 2rem;
        background-color: var(--white); border-top-left-radius: 2rem; border-top-right-radius: 2rem;
        transform: translateY(100%); transition: 1s ease-in-out;
      }
      .row { align-items: flex-end; justify-content: flex-end; }
    }

    /* Message Box */
    #messageBox {
      display: none; position: fixed; top: 20px; right: 20px;
      background: #4BB543; color: white; padding: 15px 25px; border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 9999; font-weight: bold;
      transition: opacity 0.5s ease;
    }
    #messageBox.error { background: #ff4d4d; }

    /* Forgot Password Modal */
    #forgotModal {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 9998;
    }
    #forgotModal .modal-content {
      background: #fff; padding: 20px 30px; border-radius: 10px; width: 300px; text-align: center;
    }
    #forgotModal input {
      width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;
    }
    #forgotModal button {
      background: var(--primary-color); color: white; border: none; padding: 10px 15px;
      border-radius: 5px; cursor: pointer;
    }
  </style>
</head>
<body>
<div id="container" class="container">
  <div class="row">
    <!-- Sign Up -->
    <div class="col align-items-center flex-col sign-up">
      <div class="form-wrapper align-items-center">
        <div class="form sign-up">
          <div class="input-group"><i class='bx bxs-user'></i><input type="text" placeholder="Username" id="signupUsername"></div>
          <div class="input-group"><i class='bx bx-mail-send'></i><input type="email" placeholder="Email" id="signupEmail"></div>
          <div class="input-group"><i class='bx bxs-lock-alt'></i><input type="password" placeholder="Password" id="signupPassword"></div>
          <div class="input-group"><i class='bx bxs-lock-alt'></i><input type="password" placeholder="Confirm password" id="signupConfirm"></div>
          <button onclick="signup()">Sign up</button>
          <p><span>Already have an account?</span> <b onclick="toggle()" class="pointer">Sign in here</b></p>
        </div>
      </div>
    </div>
    <!-- Sign In -->
    <div class="col align-items-center flex-col sign-in">
      <div class="form-wrapper align-items-center">
        <div class="form sign-in">
          <div class="input-group"><i class='bx bxs-user'></i><input type="text" placeholder="Username" id="loginUsername"></div>
          <div class="input-group"><i class='bx bxs-lock-alt'></i><input type="password" placeholder="Password" id="loginPassword"></div>
          <button onclick="login()">Sign in</button>
          <p><b class="pointer" onclick="openForgotModal()">Forgot password?</b></p>
          <p><span>Don't have an account?</span> <b onclick="toggle()" class="pointer">Sign up here</b></p>
        </div>
      </div>
    </div>
  </div>
  <!-- Content -->
  <div class="row content-row">
    <div class="col align-items-center flex-col"><div class="text sign-in"><h2>Welcome</h2></div><div class="img sign-in"></div></div>
    <div class="col align-items-center flex-col"><div class="img sign-up"></div><div class="text sign-up"><h2>Join with us</h2></div></div>
  </div>
</div>

<div id="messageBox"></div>

<div id="forgotModal">
  <div class="modal-content">
    <h3>Reset Password</h3>
    <input type="email" id="forgotEmail" placeholder="Enter your email">
    <button onclick="resetPassword()">Reset</button>
    <p style="margin-top:10px; cursor:pointer;" onclick="closeForgotModal()">Cancel</p>
  </div>
</div>

<script>
  let container = document.getElementById('container');
  setTimeout(() => container.classList.add('sign-in'), 200);
  function toggle() { container.classList.toggle('sign-in'); container.classList.toggle('sign-up'); }

  function showMessage(msg, error=false) {
    const box = document.getElementById('messageBox');
    box.innerText = msg; box.classList.toggle('error', error);
    box.style.display = 'block'; box.style.opacity = '1';
    setTimeout(()=>{ box.style.opacity='0'; setTimeout(()=>box.style.display='none',500); },2000);
  }

  function signup() {
    const u=document.getElementById('signupUsername').value,e=document.getElementById('signupEmail').value,
          p=document.getElementById('signupPassword').value,c=document.getElementById('signupConfirm').value;
    if(!u||!e||!p||!c) return showMessage("Please fill in all fields",true);
    if(p!==c) return showMessage("Passwords do not match",true);

    fetch('http://localhost:3000/api/auth/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: u, email: e, password: p })
    })
    .then(res => res.json())
    .then(data => {
        if(data.success) {
            showMessage("Signup successful! Please login.");
            toggle();
        } else {
            showMessage(data.message, true);
        }
    })
    .catch(err => showMessage("Error connecting to server", true));
  }

  function login() {
    const u=document.getElementById('loginUsername').value,p=document.getElementById('loginPassword').value;
    
    fetch('http://localhost:3000/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username: u, password: p })
    })
    .then(res => res.json())
    .then(data => {
        if(data.success) {
            localStorage.setItem('user', JSON.stringify(data.user));
            showMessage(`Welcome back, ${data.user.username}!`);
            setTimeout(() => {
                if(data.user.role === 'admin') window.location.href = 'admin-dashboard.html';
                else if(data.user.role === 'seller') window.location.href = 'seller-dashboard.html';
                else window.location.href = 'index.html';
            }, 1000);
        } else {
            showMessage(data.message, true);
        }
    })
    .catch(err => showMessage("Error connecting to server", true));
  }

  function openForgotModal(){document.getElementById('forgotModal').style.display='flex';}
  function closeForgotModal(){document.getElementById('forgotModal').style.display='none';}
  function resetPassword(){
    const email=document.getElementById('forgotEmail').value;
    const user=JSON.parse(localStorage.getItem('user'));
    if(user&&email===user.email){showMessage("Password reset link sent (demo)");closeForgotModal();}
    else showMessage("Email not found",true);
  }
</script>
</body>
</html>
